# pulsar-clock-corrections

Distribution point and tools for observatory clock corrections for pulsar timing

In order to precisely time pulsars, we need to know precisely when the data was
taken. Most observatories maintain their own clocks but keep track of how these
clocks deviate from International Atomic Time, usually by way of GPS. Thus to
accurately work with data from these observatories, pulsar timing software must
have access to these clock corrections. Because they are records of the
behaviour of physical clocks, these corrections cannot be predicted and
therefore one must obtain a list of clock corrections updated since the last
data point one wishes to analyze was taken. 

This package is designed to address the problem of distributing these
up-to-date clock correction files.

The intention is that this package be useful to users of the three major pieces
of pulsar timing software: TEMPO, TEMPO2, and PINT.

This package includes both the repository itself (with detailed logs of the
updating process) and some tools for maintaining it. The maintenance tools
use Python, Astropy, and PINT, but most users should have no need to run them.

To browse the repository, and for instructions on how to use the files in it,
please visit https://ipta.github.io/pulsar-clock-corrections/

## Updating clock files

The intention is that observatories will make up-to-date clock files available
on the web; in this case updates will be picked up automatically. Updates will
be checked to make sure that they are simple extensions of the existing clock
file, so that damaged clock files are not automatically imported.

Some clock files are obtained from the TEMPO or TEMPO2 repositories. For example, 
the European Pulsar Timing Array group intends the TEMPO2 repository to be the 
official repository of the up-to-date clock files that they manage. This 
repository will pick up any updates to the files in either the TEMPO or TEMPO2 
repository, subject to the same checks. Note in particular that this repository 
rejects any clock files with out-of-order MJDs; these clock files do not work 
properly in TEMPO or PINT, and are almost always erroneous. The TEMPO repository 
has at times contained such erroneous clock files, and so these are not imported 
to this repository. Nevertheless, any clock file primarily maintained in the TEMPO
or TEMPO2 repositories will be updated here; it may be appropriate to submit
updates to the appropriate repository. If these repositories are too slow to
incorporate updates, file a pull request as for manually updated files (below)
and we can discuss whether it is a good idea to incorporate the updated file.

Some clock files are generated from global data, BIPM or IERS or a similar
authority; these are generated by checking the source files provided by
these authorities and generating the clock files to be distributed here.
Such clock files should not need updating, although problems in them
should be reported as issues to this repository.

A few clock files do not have any other online repository; these need to
be updated by incorporating new clock files directly into this repository. 
I suggest you file a pull request that simply replaces the clock file with
its updated form. Please try running `update_clock_corrections.py` before
submitting the PR; this should catch any problems like out-of-order clock
corrections within the new file.

### BIPM
When new BIPM files are added each year, they need to be explicitly included in this repository.
This can be done by creating a new PR with:

```
python ./update_clock_corrections.py --file tai2tt_bipm2024.clk --no-respect-interval --gh-pages ./gh-pages
git add T2runtime/clock/tai2tt_bipm2024.clk log/T2runtime/clock/tai2tt_bipm2024.clk.log index.txt
git commit ...
```
